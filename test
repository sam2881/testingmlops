def generate_select_expressions(df):
    seen = {}
    expressions = []

    for full_name in df.columns:
        parts = full_name.split('.')
        simple_name = parts[-1]
        alias_name = camel_to_snake(simple_name)

        # Ensure uniqueness by appending parent names if necessary
        temp_name = alias_name
        depth = 2
        while temp_name in seen:
            if len(parts) >= depth:
                parent_name = camel_to_snake(parts[-depth])
                temp_name = f"{parent_name}_{alias_name}"
            depth += 1

        seen[temp_name] = True
        expressions.append(col(full_name).alias(temp_name))

    return df.select(*expressions)
