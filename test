def generate_select_expression(df):
    """Generate a DataFrame select expression with properly aliased columns."""
    column_names = df.columns
    aliases = {}
    for col_name in column_names:
        base_name = col_name.split('.')[-1]
        snake_case_name = camel_to_snake(base_name)
        if snake_case_name in aliases:
            parent = col_name.split('.')[-2]
            snake_case_name = camel_to_snake(parent) + '_' + snake_case_name
        aliases[col_name] = snake_case_name

    select_expr = [col(name).alias(aliases[name]) for name in column_names]
    return df.select(*select_expr
