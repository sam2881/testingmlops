def generate_select_expression(df):
    """Generate a DataFrame select expression with properly aliased columns."""
    column_names = df.columns
    seen_aliases = {}
    select_expr = []

    for col_name in column_names:
        simple_name = col_name.split('.')[-1]
        snake_case_name = camel_to_snake(simple_name)
        if snake_case_name in seen_aliases:
            parent = col_name.split('.')[-2]
            snake_case_name = camel_to_snake(parent) + '_' + snake_case_name
        seen_aliases[snake_case_name] = col_name
        select_expr.append(col(col_name).alias(snake_case_name))

    return df.select(*select_expr)
