def generate_select_columns(schema, parent_prefix="", parent_alias=""):
    """Generate a list of column names based on the DataFrame schema."""
    columns = []
    for field in schema.fields:
        full_field_name = f"{parent_prefix}{field.name}" if parent_prefix else field.name
        alias_name = field.name if not parent_alias else f"{parent_alias}_{field.name}"

        if isinstance(field.dataType, StructType):
            nested_columns = generate_select_columns(field.dataType, full_field_name + ".", alias_name)
            columns.extend(nested_columns)
        elif isinstance(field.dataType, ArrayType):
            columns.append(full_field_name)
        else:
            columns.append(full_field_name)
    return columns
