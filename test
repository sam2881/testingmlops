def extract_column_names(schema, parent_prefix=""):
    """Extract column names based on the DataFrame schema."""
    column_names = []
    for field in schema.fields:
        full_field_name = f"{parent_prefix}{field.name}" if parent_prefix else field.name
        if isinstance(field.dataType, StructType):
            nested_columns = extract_column_names(field.dataType, full_field_name + ".")
            column_names.extend(nested_columns)
        elif isinstance(field.dataType, ArrayType):
            element_type = field.dataType.elementType
            if isinstance(element_type, StructType):
                nested_columns = extract_column_names(element_type, full_field_name + ".")
                column_names.extend(nested_columns)
            else:
                column_names.append(full_field_name)
        else:
            column_names.append(full_field_name)
    return column_names
